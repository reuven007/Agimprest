<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgiPrest</title>
</head>
<link rel="stylesheet" href="../public/assets/css/style.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<script src="../public/assets/js/jquery/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.6/jquery.inputmask.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="../public/assets/js/script.js"></script>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid ">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown"
                aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav">

                    <li class="nav-item dropdown">
                        <a class="nav-link" href="/agimprest/index.html" id="navbarDropdownMenuLink">
                            Agimprest
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="cadastro" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            CADASTRO
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                            <li><a class="dropdown-item" href="/agimprest/cadastro/empresa.html">Empresa</a></li>
                            <li><a class="dropdown-item" href="/agimprest/cadastro/cliente.html">Cliente</a></li>
                            <li><a class="dropdown-item" href="/agimprest/cadastro/usuario.html">Usuário</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="movimentacoes" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            MOVIMENTAÇÕES
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                            <li><a class="dropdown-item"
                                    href="/agimprest/movimentacoes/movimentacoes.html">Listar </a></li>
                        </ul>
                    </li>

                </ul>
            </div>
        </div>
        <div class="justify-content-end d-flex col">
            <div class="d-flex justify-content-center" style="flex-basis: min-content;
                flex-direction: column;align-items: center;">
                <div class="avatar avatar-usuario"></div>
                <span id="nome-usuario">Usuario</span>
            </div>
        </div>

    </nav>



    <div class="container mt-5 mb-5 section-center">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <form id="form-cadastro-usuario" class="row g-3 needs-validation">
                    <div class="col-md-12 mb-3">
                        <label for="usuario" class="form-label">Usuário (E-mail)</label>
                        <input type="email" class="form-control" id="usuario" name="usuario" required>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label for="senha" class="form-label">Senha</label>
                        <input type="password" class="form-control" id="senha" name="senha" required>
                        <div class="valid-feedback">
                            Parece Bom!
                        </div>
                        <div class="invalid-feedback">
                            Insira um Senha valida/existente.
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label for="confirma-senha" class="form-label">Confirme a Senha</label>
                        <input type="password" class="form-control" id="confirma-senha" name="confirma-senha" required>
                        <div class="valid-feedback">
                            Parece Bom!
                        </div>
                        <div class="invalid-feedback">
                            Insira um Senha valida/existente.
                        </div>
                    </div>

                    <div class="col-md-12 mb-3">
                        <label for="categoria" class="form-label">Categoria</label>
                        <select class="form-control" id="categoria" name="categoria" required>
                            <div class="valid-feedback">
                                Parece Bom!
                            </div>
                            <div class="invalid-feedback">
                                Insira uma Categoria valido/existente.
                            </div>
                            <option selected disabled>Selecione uma categoria...</option>
                            <option>Administrador</option>
                            <option>Operador</option>
                        </select>
                    </div>
                    <div class="d-flex justify-content-between"> <button type="button" class="btn btn-primary"
                            id="salvar">Salvar</button>
                        <button type="button" class="btn btn-success" id="listar">Listagem de usuários</button>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-3">
        <div class="container">
            <div class="row">
                <div class="col">
                    <p>Todos os direitos reservados &copy; 2023</p>
                </div>
            </div>
        </div>
    </footer>
    </footer>

    <script>
        $("#listar").click((event) => { window.location.href = "../listagem/listagem-usuario.html"; event.preventDefault })
        $("#salvar").click(event => {

            if (validaFormulario(event)) {

                const usuario = $("#usuario");
                const senha = $("#senha");
                const confirmaSenha = $("#confirmaSenha");
                const categoria = $("#categoria");

                if (senha.val() != confirmaSenha.val()) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'As senhas nao batem!'
                    })
                } else {
                    const usuarios = window.localStorage.getItem("usuarios")
                    if (usuarios != undefined) {
                        const users = Array.from(JSON.parse(usuarios))
                        users.push({ usuario: usuario.val(), senha: senha.val(), categoria: categoria.val() })
                        window.localStorage.setItem("usuarios", JSON.stringify(users))
                    } else {
                        window.localStorage.setItem("usuarios", JSON.stringify([{ usuario: usuario.val(), senha: senha.val(), categoria: categoria.val() }]))
                    }
                    usuario.val("")
                    senha.val("")
                    confirmaSenha.val("")
                    categoria.val("")
                }
            }
        })
    </script>

</body>

</html>